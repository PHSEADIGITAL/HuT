<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title><%= title ? `${title} | ${appName}` : appName %></title>
    <link rel="stylesheet" href="/styles.css" />
  </head>
  <body class="<%= currentPath && currentPath.startsWith('/marketplace') ? 'marketplace-mode' : '' %>">
    <header class="topbar">
      <div class="container topbar-inner">
        <a class="brand" href="/">Hut!</a>
        <nav class="nav">
          <a href="/">Stays</a>
          <a href="/marketplace">Marketplace</a>
          <% if (currentUser) { %>
            <a href="/wallet">Wallet</a>
          <% } %>
          <% if (currentUser && (currentUser.role === "hotel_admin" || currentUser.role === "platform_admin")) { %>
            <a href="/admin">Hotel Admin</a>
          <% } %>
          <% if (currentUser && currentUser.role === "platform_admin") { %>
            <a href="/admin/owner-dashboard">Owner Dashboard</a>
          <% } %>
          <% if (currentUser && currentUser.role === "platform_admin") { %>
            <a href="/admin/hotels/new">Onboard Hotel</a>
          <% } %>
        </nav>
        <div class="auth-actions">
          <% if (currentUser) { %>
            <span class="muted tiny">Signed in: <strong><%= currentUser.name %></strong> (<%= currentUser.role %>)</span>
            <form method="POST" action="/auth/logout">
              <button type="submit" class="ghost-btn">Logout</button>
            </form>
          <% } else { %>
            <a class="ghost-link" href="/auth/login">Sign in</a>
            <a class="button-link small" href="/auth/register">Create account</a>
          <% } %>
        </div>
      </div>
    </header>
    <section class="platform-tabs-wrap">
      <div class="container platform-tabs">
        <a class="platform-tab <%= currentPath === '/' || currentPath.startsWith('/hotels') ? 'active' : '' %>" href="/">Stays</a>
        <a class="platform-tab <%= currentPath.startsWith('/marketplace') ? 'active' : '' %>" href="/marketplace">Marketplace</a>
        <% if (currentUser) { %>
          <a class="platform-tab <%= currentPath.startsWith('/wallet') ? 'active' : '' %>" href="/wallet">Wallet</a>
        <% } %>
      </div>
    </section>
    <% if (flash && flash.message) { %>
      <section class="container flash <%= flash.type === 'success' ? 'flash-success' : 'flash-error' %>">
        <p><%= flash.message %></p>
      </section>
    <% } %>
    <main class="container">
