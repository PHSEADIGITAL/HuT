<%- include("partials/header", { title: "Bonny Island Hotels" }) %>

<section class="card landing-switcher">
  <div>
    <p class="eyebrow">Choose your experience</p>
    <h2>Discover. Compare. Book - Your Perfect Stay, All in One Marketplace</h2>
    <p class="muted tiny">
      Pick where you want to go first, then use back/forward buttons to navigate quickly.
    </p>
  </div>
  <div class="landing-switcher-actions">
    <a class="button-link" href="/marketplace">Go to Marketplace</a>
    <a class="ghost-link" href="#hotel-booking-search">Go to Hotel Booking</a>
    <button type="button" class="ghost-btn js-history-back">Back</button>
    <button type="button" class="ghost-btn js-history-forward">Forward</button>
  </div>
</section>

<section class="booking-hero">
  <div id="hotel-booking-search"></div>
  <div class="booking-hero-content">
    <p class="eyebrow">HuT Stays</p>
    <h1>Find your next stay in Bonny Island</h1>
    <p>
      Search by destination, compare top-rated properties, and book instantly with secure online
      payment and live availability.
    </p>
  </div>
  <form class="booking-search-bar" method="GET" action="/">
    <div class="booking-field wide">
      <label for="destination">Destination</label>
      <input
        id="destination"
        name="destination"
        type="text"
        value="<%= search.destination %>"
        placeholder="Where are you going?"
      />
    </div>
    <div class="booking-field">
      <label for="checkInDate">Check-in</label>
      <input id="checkInDate" type="date" name="checkInDate" value="<%= checkInDate %>" required />
    </div>
    <div class="booking-field">
      <label for="checkOutDate">Check-out</label>
      <input id="checkOutDate" type="date" name="checkOutDate" value="<%= checkOutDate %>" required />
    </div>
    <div class="booking-field">
      <label for="adults">Adults</label>
      <input id="adults" name="adults" type="number" min="1" value="<%= search.adults %>" />
    </div>
    <div class="booking-field">
      <label for="rooms">Rooms</label>
      <input id="rooms" name="rooms" type="number" min="1" value="<%= search.rooms %>" />
    </div>
    <div class="booking-field">
      <label for="sort">Sort</label>
      <select id="sort" name="sort">
        <option value="recommended" <%= search.sortBy === "recommended" ? "selected" : "" %>>Recommended</option>
        <option value="price_asc" <%= search.sortBy === "price_asc" ? "selected" : "" %>>Price (low to high)</option>
        <option value="price_desc" <%= search.sortBy === "price_desc" ? "selected" : "" %>>Price (high to low)</option>
        <option value="rating_desc" <%= search.sortBy === "rating_desc" ? "selected" : "" %>>Guest rating</option>
        <option value="distance" <%= search.sortBy === "distance" ? "selected" : "" %>>Distance to center</option>
      </select>
    </div>
    <div class="booking-field">
      <label for="minPrice">Min price</label>
      <input id="minPrice" name="minPrice" type="number" min="0" value="<%= search.minPrice %>" />
    </div>
    <div class="booking-field">
      <label for="maxPrice">Max price</label>
      <input id="maxPrice" name="maxPrice" type="number" min="0" value="<%= search.maxPrice %>" />
    </div>
    <div class="booking-field search-btn-wrap">
      <button type="submit" class="search-btn">Search</button>
    </div>
  </form>
</section>

<section class="results-shell">
  <aside class="card results-sidebar">
    <h3>Search summary</h3>
    <p class="muted"><strong><%= resultStats.count %></strong> properties found</p>
    <ul class="summary-list">
      <li>Destination: <strong><%= search.destination %></strong></li>
      <li>Dates: <strong><%= checkInDate %> - <%= checkOutDate %></strong></li>
      <li>Guests: <strong><%= search.adults %> adults, <%= search.rooms %> room(s)</strong></li>
    </ul>
    <hr />
    <h4>Popular facilities</h4>
    <div class="chip-list">
      <span class="chip">Free WiFi</span>
      <span class="chip">Breakfast</span>
      <span class="chip">Airport pickup</span>
      <span class="chip">Pool</span>
      <span class="chip">Family rooms</span>
      <span class="chip">Parking</span>
    </div>
  </aside>

  <div class="results-list">
    <div class="section-header">
      <h2>Stays in <%= search.destination %></h2>
      <p class="muted">
        Showing <strong><%= resultStats.count %></strong> of <%= resultStats.total %> properties
      </p>
    </div>
    <% if (!hotels.length) { %>
      <article class="card">
        <h3>No properties matched your search.</h3>
        <p class="muted">Try changing destination, dates, or price filters.</p>
      </article>
    <% } %>

    <% hotels.forEach((hotel) => { %>
      <article class="search-result-card">
        <a class="result-media" href="/hotels/<%= hotel.id %>?destination=<%= encodeURIComponent(search.destination) %>&checkInDate=<%= checkInDate %>&checkOutDate=<%= checkOutDate %>&adults=<%= search.adults %>&rooms=<%= search.rooms %>">
          <img src="<%= hotel.coverImage %>" alt="<%= hotel.name %> cover image" />
        </a>
        <div class="result-main">
          <div class="result-title-row">
            <h3>
              <a href="/hotels/<%= hotel.id %>?destination=<%= encodeURIComponent(search.destination) %>&checkInDate=<%= checkInDate %>&checkOutDate=<%= checkOutDate %>&adults=<%= search.adults %>&rooms=<%= search.rooms %>">
                <%= hotel.name %>
              </a>
            </h3>
            <% if (hotel.premiumListingActive) { %>
              <span class="badge premium">Preferred Plus</span>
            <% } %>
          </div>
          <div class="result-meta muted">
            <span><%= "â˜…".repeat(hotel.starRating) %> <%= hotel.propertyType %></span>
            <span><%= hotel.distanceToCenterKm %> km from center</span>
          </div>
          <p class="result-location"><%= hotel.location %></p>
          <p class="hotel-description"><%= hotel.description %></p>
          <div class="result-amenities">
            <% (hotel.amenities || []).slice(0, 3).forEach((item) => { %>
              <span class="chip"><%= item %></span>
            <% }) %>
          </div>
          <div class="result-room-types muted tiny">
            Room options: <%= hotel.roomTypePreview.join(", ") %>
          </div>
        </div>
        <div class="result-side">
          <div class="review-pill">
            <div>
              <p><%= hotel.reviewLabel %></p>
              <span class="muted tiny"><%= hotel.reviewCount %> reviews</span>
            </div>
            <strong><%= hotel.reviewScore %></strong>
          </div>
          <p class="muted tiny"><%= hotel.roomsAvailable %> rooms left for your dates</p>
          <p class="price-anchor tiny"><span class="anchor-original"><%= formatNaira(calculateAnchoredPrice(hotel.minPrice, 0.2)) %></span></p>
          <p class="price">Now <strong><%= formatNaira(hotel.minPrice) %></strong></p>
          <p class="muted tiny">includes service charge at checkout</p>
          <a class="button-link full-width" href="/hotels/<%= hotel.id %>?destination=<%= encodeURIComponent(search.destination) %>&checkInDate=<%= checkInDate %>&checkOutDate=<%= checkOutDate %>&adults=<%= search.adults %>&rooms=<%= search.rooms %>">See availability</a>
        </div>
      </article>
    <% }) %>
  </div>
</section>

<%- include("partials/footer", { platform }) %>
